<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="https://tmabraham.github.io/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://tmabraham.github.io/blog/" rel="alternate" type="text/html" /><updated>2021-05-28T02:21:52-05:00</updated><id>https://tmabraham.github.io/blog/feed.xml</id><title type="html">Tanishq Abrahamâ€™s blog</title><subtitle>My blog with tutorials and thoughts.</subtitle><entry><title type="html">Introducing Noisy Imagenette</title><link href="https://tmabraham.github.io/blog/noisy_imagenette" rel="alternate" type="text/html" title="Introducing Noisy Imagenette" /><published>2021-03-02T00:00:00-06:00</published><updated>2021-03-02T00:00:00-06:00</updated><id>https://tmabraham.github.io/blog/Noisy-Imagenette</id><content type="html" xml:base="https://tmabraham.github.io/blog/noisy_imagenette">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-03-02-Noisy-Imagenette.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;TL;DR:&lt;/strong&gt; We introduce a dataset, Noisy Imagenette, which is a version of the Imagenette dataset with noisy labels. We hope this dataset is useful for rapid experimentation and testing of methods to address noisy label training.&lt;/p&gt;
&lt;h1 id=&quot;Introduction&quot;&gt;Introduction&lt;a class=&quot;anchor-link&quot; href=&quot;#Introduction&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;Dataset-have-noisy-labels!&quot;&gt;Dataset have noisy labels!&lt;a class=&quot;anchor-link&quot; href=&quot;#Dataset-have-noisy-labels!&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Deep learning has led to impressive results on datasets of all types, but its success often shines when models are trained with large datasets with human-annotated labels (extreme example: GPT-3 and more recently CLIP/ALIGN/DALL-E). A major challenge when constructing these datasets is obtaining enough labels to train a neural network model. There is an inherent tradeoff between the quality of the annotations and the cost of annotation (in the form of time or money). For example, while using sources like Amazon Mechanical Turk provide cheap labeling, the use of these non-expert labeling services will often produce unreliable labels. This is what is referred to as noisy labels, as these unreliable labels are not necessarily ground truth. Unfortunately, neural networks are known to be susceptible to overfitting to noisy labels (see &lt;a href=&quot;https://arxiv.org/abs/1611.03530&quot;&gt;here&lt;/a&gt;) which means alternative approaches are needed to achieve good generalization in the presence of noisy labels.&lt;/p&gt;
&lt;h2 id=&quot;Prior-research-on-noisy-labels&quot;&gt;Prior research on noisy labels&lt;a class=&quot;anchor-link&quot; href=&quot;#Prior-research-on-noisy-labels&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Recently, many techniques have been presented in order to address label noise. These include novel loss functions like &lt;a href=&quot;https://arxiv.org/abs/1906.03361&quot;&gt;Bi-Tempered Logistic Loss&lt;/a&gt;&lt;a href=&quot;https://www.ijcai.org/Proceedings/2020/305&quot;&gt;Taylor Cross Entropy Loss&lt;/a&gt;, or &lt;a href=&quot;https://arxiv.org/abs/1908.06112&quot;&gt;Symmetric Cross Entropy&lt;/a&gt;. Additionally, there are many novel training techniques that have been recently developed like &lt;a href=&quot;https://arxiv.org/abs/1911.09781&quot;&gt;MentorMix&lt;/a&gt;, &lt;a href=&quot;https://arxiv.org/abs/2002.07394&quot;&gt;DivideMix&lt;/a&gt;, &lt;a href=&quot;https://arxiv.org/abs/2007.00151&quot;&gt;Early-Learning Regularization&lt;/a&gt; and &lt;a href=&quot;https://openreview.net/forum?id=D1E1h-K3jso&quot;&gt;Noise-Robust Contrastive Learning&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Most of these papers are using MNIST, SVHN, CIFAR10 or related datasets with synthetically-added noise. Other common datasets are the WebVision and Clothing1M datasets, which are real-world noisy, large-scale datasets with millions of images. Therefore there is an opportunity to develop a mid-scale dataset that allows for rapid prototyping but is complex enough to provide useful results when it comes to noisy label training.&lt;/p&gt;
&lt;h2 id=&quot;fastai's-Imagenette---a-dataset-for-rapid-prototyping&quot;&gt;fastai's Imagenette - a dataset for rapid prototyping&lt;a class=&quot;anchor-link&quot; href=&quot;#fastai's-Imagenette---a-dataset-for-rapid-prototyping&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The idea of mid-scale datasets for rapid prototyping has been explored in the past. For example, in 2019, fast.ai &lt;a href=&quot;https://github.com/fastai/imagenette&quot;&gt;released&lt;/a&gt; the Imagenette and Imagewoof datasets (subsequently updated in 2020), subsets of Imagenet for rapid experimentation and prototyping. It can serve as a small dataset proxy for the ImageNet, or a dataset with more complexity than MNIST or CIFAR10 but still small and simple enough for benchmarking and rapid experimentation. This dataset has been used to test and establish new training techniques like &lt;a href=&quot;https://arxiv.org/abs/1908.08681&quot;&gt;Mish activation function&lt;/a&gt; and &lt;a href=&quot;https://forums.fast.ai/t/meet-ranger-radam-lookahead-optimizer/52886&quot;&gt;Ranger optimizer&lt;/a&gt; (see &lt;a href=&quot;https://forums.fast.ai/t/how-we-beat-the-5-epoch-imagewoof-leaderboard-score-some-new-techniques-to-consider/53453&quot;&gt;here&lt;/a&gt;). The dataset also has been used in various papers (see &lt;a href=&quot;https://arxiv.org/abs/2004.07629&quot;&gt;here&lt;/a&gt;, &lt;a href=&quot;https://arxiv.org/abs/2007.15248&quot;&gt;here&lt;/a&gt;, &lt;a href=&quot;https://arxiv.org/abs/1906.04887&quot;&gt;here&lt;/a&gt;, &lt;a href=&quot;https://arxiv.org/abs/2101.06639&quot;&gt;here&lt;/a&gt;, &lt;a href=&quot;https://arxiv.org/abs/2006.05624&quot;&gt;here&lt;/a&gt;, and &lt;a href=&quot;https://www.sciencedirect.com/science/article/pii/S1047320321000134?casa_token=uL4_SoQQgKsAAAAA:CPGu3HeZVciBO5YEocTnziH7YVhbcGF0JCpB0JuJi2pqHmkaAKibhaVYe-3t07nxtpdem2lv&quot;&gt;here&lt;/a&gt;). Clearly, this dataset has been quite useful to machine learning researchers and practitioners for testing and comparing new methods. We believe that an analogous dataset could be useful to researchers with modest compute for testing and comparing new methods for addressing label noise.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Introducing-Noisy-Imagenette&quot;&gt;Introducing Noisy Imagenette&lt;a class=&quot;anchor-link&quot; href=&quot;#Introducing-Noisy-Imagenette&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;We introduce Noisy Imagenette, a version of Imagenette (and Imagewoof) that has synthetically noisy labels at different levels: 1%, 5%, 25%, and 50% incorrect labels. The Noisy Imagenette dataset already comes with the Imagenette dataset:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;fastai.vision.all&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;untar_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;URLs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IMAGENETTE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;While the regular labels for Imagenette dataset are given as the names of the image folder, the noisy labels are provided as a separate CSV file with columns corresponding to the image filename and labels for each of the different noise levels:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;noisy_imagenette.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;csv_file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;path&lt;/th&gt;
      &lt;th&gt;noisy_labels_0&lt;/th&gt;
      &lt;th&gt;noisy_labels_1&lt;/th&gt;
      &lt;th&gt;noisy_labels_5&lt;/th&gt;
      &lt;th&gt;noisy_labels_25&lt;/th&gt;
      &lt;th&gt;noisy_labels_50&lt;/th&gt;
      &lt;th&gt;is_valid&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;train/n02979186/n02979186_9036.JPEG&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;train/n02979186/n02979186_11957.JPEG&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n03000684&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;train/n02979186/n02979186_9715.JPEG&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n03417042&lt;/td&gt;
      &lt;td&gt;n03000684&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;train/n02979186/n02979186_21736.JPEG&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n03417042&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;train/n02979186/ILSVRC2012_val_00046953.JPEG&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n02979186&lt;/td&gt;
      &lt;td&gt;n03394916&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The generation of these noisy labels are provided in &lt;a href=&quot;https://github.com/fastai/imagenette/blob/master/noisy_labels/generate_labels.ipynb&quot;&gt;this Jupyter notebook&lt;/a&gt;. We have also updated fastai's &lt;a href=&quot;https://github.com/fastai/fastai/blob/master/nbs/examples/train_imagenette.py&quot;&gt;train_imagenette.py&lt;/a&gt; to utilize the new noisy labels. If you want to train on the Noisy Imagenette dataset using this script, just simply pass the &lt;code&gt;--pct-noise&lt;/code&gt; argument to the script with the desired noise level.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info&quot; viewBox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; width=&quot;16&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;The validation set remains clean and its labels are not changed. While technically the accuracy metric &lt;a href=&quot;https://arxiv.org/abs/2012.04193&quot;&gt;is robust&lt;/a&gt; to noise, I believe it&amp;#8217;s simpler to use a clean validation set to clearly understand see if a model is learning appropriate decision boundaries on the ground truth.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;For the original Imagenette dataset, there are technically (3 image sizes)*(4 number of epoch levels) for both Imagenette and Imagewoof giving a total of 24 leaderboards. If we had each of these 24 leaderboards for the previously mentioned 4 noise levels (1%, 5%, 25%, 50%), that would give us 96 leaderboards! Instead, the &lt;a href=&quot;https://github.com/fastai/imagenette&quot;&gt;Imagenette repository&lt;/a&gt; only maintains leaderboards for Noisy Imagenette (and not Imagewoof) for 5% and 50% noise (24 leaderboards). Just like with the regular Imagenette leaderboards, feel free to send a pull request to the Imagenette repository with your results if it beats the current top score.  I have provided a &lt;a href=&quot;https://github.com/tmabraham/noisy_imagenette/blob/main/baseline/baseline-01-18-2021.md&quot;&gt;baseline&lt;/a&gt; which is currently on the leaderboards, as well as a &lt;a href=&quot;https://github.com/fastai/imagenette/blob/master/noisy_labels/extended_lb.csv&quot;&gt;CSV file&lt;/a&gt; with the baseline accuracy for all 96 leaderboards.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Backstory&quot;&gt;Backstory&lt;a class=&quot;anchor-link&quot; href=&quot;#Backstory&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;For some background, I started looking into training with label noise because of the recent Cassava Leaf Disease Kaggle Competition (my team was able win a silver medal, see &lt;a href=&quot;https://twitter.com/iScienceLuvr/status/1362879523650330627&quot;&gt;here&lt;/a&gt;), which had a really noisy dataset. One of the recent techniques I heard about was &lt;a href=&quot;https://arxiv.org/abs/2010.01412&quot;&gt;SAM&lt;/a&gt;, which recently achieved a state-of-the-art score on ImageNet (only to be beaten in a few weeks by techniques/models like Meta Pseudo Labels and NFNets). However, the paper also included some improvements to noisy label training. I had a fastai implementation in-progress for the SAM optimizer (probably will describe in an upcoming blog post) and I wanted to test out its noisy label training capabilities on a dataset. I thought about corrupting the Imagenette labels and use that as my dataset for testing SAM. Jeremy Howard suggested adding it to the main Imagenette dataset and here we are!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Closing-Remarks&quot;&gt;Closing Remarks&lt;a class=&quot;anchor-link&quot; href=&quot;#Closing-Remarks&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In conclusion, I hope that this Noisy Imagenette datasets serves as a useful benchmarking dataset for machine learning community when it comes to testing and comparing techniques for training on noisy labels. I hope to experiment with some of these techniques like SAM, the different loss functions, etc. and record those results over on this blog, so be sure to keep an eye on this blog, or follow me on &lt;a href=&quot;https://twitter.com/iScienceLuvr&quot;&gt;Twitter&lt;/a&gt; to get the latest updates!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Acknowledgments&quot;&gt;Acknowledgments&lt;a class=&quot;anchor-link&quot; href=&quot;#Acknowledgments&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;I'd like to thank Jeremy Howard and especially Hamel Husain for adding the Noisy Imagenette dataset. I also would like to thank Hamel Husain for reviewing my blog post and providing feedback. I'd like to thank Isaac Flath for pointing out an error I originally had when generating the dataset.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="deep learning" /><category term="imagenette" /><summary type="html"></summary></entry></feed>